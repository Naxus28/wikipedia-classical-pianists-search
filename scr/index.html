<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <script
  src="https://code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.2/lodash.min.js"></script>
</head>
<body>
  <div class="wrapper">
    <input type="text" class="search" placeholder="Search pianist">
    <div class="pianists_wrapper">
      <p></p>
    </div>
  </div>
  
  <script type="text/javascript">
    $(document).ready(function(){
      
      // var to hold wikipedia content from API
      var pianistsArray = [];

      $('.search').on('keyup', function(e) {
        if (e.target.value.length > 2) {

          // var pianist = _.find(pianistsArray);
       
        }
      });
      function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }


      function parseRawWikipediaContent(rawStringContent) {
        // see pattern here: http://regexr.com/3er2s
        return rawStringContent.replace(new RegExp(/[[\]]|\u21b5|{{div col end}}|{{div col\|cols=3}}|:fr:Jean-Marc Savelli|Jean-Marc Savelli|==+[A-Z].*|==+[A-Z].*/, 'g'), '');
      }

      function makePianistsArrayAndSort(parsedStringContent) {
        var arrayOfPianists = parsedStringContent.split('*');
        // remove first index because it is the intro text for the page
        arrayOfPianists = arrayOfPianists.slice(1, arrayOfPianists.length-1); 
        arrayOfPianists.sort();

        return arrayOfPianists;
      }

      function renderPianistsOnScreen(pianistsArray) {
        for (i=0; i < pianistsArray.length; i++) {
          var red = getRandomInt(50, 200);
          var green = getRandomInt(50, 200);
          var blue = getRandomInt(50, 200);

          var background = 'rgb('+ red + ',' + green + ',' + blue +')';

           $('.pianists_wrapper').append('<span style="padding: 10px; margin: 5px; display: inline-block; background:' + background + '">' + pianistsArray[i] + '</span>')
        }
      }

      $.ajax({
        type: "GET",
        url: "http://en.wikipedia.org/w/api.php?format=json&action=query&titles=List_of_classical_pianists&prop=revisions&rvprop=content&callback=?",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data, textStatus, jqXHR) {
          var rawStringContent = data.query.pages['2377133'].revisions[0]['*'];
          var parsedStringContent = parseRawWikipediaContent(rawStringContent);
          pianistsArray = makePianistsArrayAndSort(parsedStringContent);
          renderPianistsOnScreen(pianistsArray);
          console.log(pianistsArray);
        },
        error: function (errorMessage) {
          console.warn('Error accesing wikipedia API');
        }
      });
    });


  </script>
</body>
</html>